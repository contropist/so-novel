/* 退党 禁评的理由 总统包子习 The##Xi##Factor（习近平因素） 字共狗 Criminal##Xi##"Xitler"##Jinping shit##hole##bing##fa 习时代 大大品牌 中字头组长 灰习牛 屎進瓶 云视察 习卒习 北红尾鸲 爱新觉罗近平 动物之森 武当七侠的政治斗争 CoronaXi 彩色熊 習敗北 坡涛汹涌 瘟疫领主习近平 青年大学包 习教父 感恩教育 习大犬 羽日帝 人尽皆知的体育迷 次级乳包 百万雄师事件 大锅瞻遗 翡翠娘娘 維尼頌 平&强 包包侠 习匪 维尼写史 bingbang帝 戏包皮 A##Big##Deal 背书单 包惠帝 习付 末代皇帝 赵人13 习背书 习包子 十里山路不换肩 親自視頻 我是一个足球迷 乳包文化 清华毕业 崇祯 维尼挂彩 坡涛汹涌 习梦撕 玉习大帝 包子病毒 喜包皮 习二卒 NMSL 头上三尺有神明 习皇帝 劝进 洗尽贫 人均接近八千万 习屎黄 神明论 终身领导人 SB包子 万岁 习厉王 维尼DISCO 梁家河 民进党 毛近平 习歪嘴 祈翠 “梦回大清” 仲夏夜之中国梦 撒币宝 习三拍 朝令夕改 习语 阿道夫-习 游泳一千米 习躲躲 Voice##of##Pooh 习猪席 孤独的毒王 中国离岸隐匿资产管理工作领导小组组组长 阳台上的哨兵 叩谢习恩 中国拉清单工作领导小组组长 不强自息 习总 总加速师 刁二将 中国离岸隐匿资产管理工作领导小组组组长 刁斤二 习太孑 狙击手待命 庆丰帝的千秋梦 集金pay 武统时代 梁家河贵族 二百五大帝 叩谢习恩 恩重如删 疯狂宇宙包 猪禁评 读稿机 包子露宪 非洲大撒币 中国首席造梦大师 学包分子 墨索里习 习博士 袁世凯第二 包子金刚腿 屎禁评 习思想 家业论 假.."~bang！卒 近日成 喷粪帝 专治各种不服 庆丰废物 天安门合法继承人 形式主义防疫 习下台 习二蛋 做N届的主席 狙击手布阵 人民战争 通商宽衣 包子兵法 10号跳跳虎被维尼拉清单 口罩大会 秦城监狱 人民领袖 皇帝亲临忠诚的武汉 维尼带货 刁槑夶尛 甴近平 足球外交 帝皇頌 满脸喷粪 Mr##Shithole nmslese##dream 裸宽包子劾心 亲自脱贫 骑巨龙 鞋哥 习夶 口罩外交 九评 战“疫”金句 宽衣撸绣单肩扛麦光腚拉碾歪脖撒币小学博士帝 野心习 哲欣 文明其精神 习孢子 清零宗、清零帝 粪坑先生 习一尊 XDD 习近平光辉形象 毛装 清单帝 习犬犬 傻大头 截颈平 昆明湖涨潮 维尼警察（X） 习是春绿 习近砰 错误执行者 习尽贫 总书记来我家 吸包皮 习尔布特 virus##king 刁斤山 庆丰称帝 习大帝 包经 习条英机 国王 中国特色射秽煮疫制度 包皇 “登机”（与登基同音） 巴拿马文件 習大佬 外交习语 刁人13 720事件 战疫国 刁近乎 vop 疯狂宇宙大帝 冲塔 万岁来武汉了 习家军 公车上书 动物庄园 习狍 梦帝 甴种 最后领导人 学包率 倒车斯基 瘟疫降生习近平 习梦思 五毛主席 断崖式下跌 一天游泳一千米 枪毙名单 裹嘎举吸钢闸门 慨撒大帝 习二世胡亥 腊肉包 习武帝 基拉大和习近平 习宽衣 毛进平 黄俄 糟糕皇帝 九大诉求 那翠化 习式病毒 号尿壶公 “复辟” 习王的田野上 送礼平 倒车帝 第22条军规 恐惊天上人 十日文革 刁大犬 任志强 韦来书记 号屎洞 耀眼黄红黄 万岁来武汉 维尼快乐组织（Winnie##Happy##Organization）简称WHO 親自蒞臨 岿然不动 共哀宗 习达姆 第一书记王沪宁 大撒币 宽衣大帝 萨格尔王 维尼之声 动森 任大炮 赵付 禁评大帝 维尼史 狙击手待命 毛魔转世 讨习檄文 氼兲嫑炛 赛禁评 扛麦郎 恩维尔·霍习 包禁评 人类命运共同体首席架构师 书单吟诵者 武汉委托李克强 抗麦套装 习远凸 坟头蹦迪 纳翠党 习言乱语 蹄防 毛二习 V尼哥 习三点 包子宪法 习病法 两会期间+隐瞒 亲自指挥疫情 每日祈翠 一带一路 习尿瓶 习奥赛斯库 扛麦帝 惜包皮 称帝修宪 该违禁词汇由 GitCode 官方生成，仅用于测试，请勿传播！ 智商不重要 386系统驱动游戏 大国造疫 现任匪首 追思焦裕禄 灭共助推器 屎侯 儿童习典 习流氓 野兽主席 不同意的举手##没有##没有 嘻包皮 维持会长 野兽先辈 习匪帝 颐指气使 头号球迷 祈翠語言包 习##卡##巴##卡 倒车 半羽习近平 甩锅侠 亲自考察 东瘟疫之地统治者暨全境守护者 学包积极分子 大海掀翻小池塘 习包子的Fa 小学居士 世界最强乞丐 时间控制 修宪 红旗下的蛋 迈克尔·索伊 独裁者 闹得欢 Cicada##3301##XD 官僚主义 不知名氏 习king 平话 习蛤 颐使气指 习得梁家书卷 添宪宝宝 当代秦始皇 主席贺词 维尼梗有害 彩色哥 蔡英文最强助选 习澳塞斯库 超邓赶毛 习猪下台 你是反贼吗 大大招牌 二百斤 习正日 习猪头 爱新觉罗·近平 Heil##Xitler 赵弹 夶 洗包皮 乳制品 崇祯帝 皇帝的新衣 尊蛤讨包 相信有神论的物理学博士 Chairman##Xi 禁评封号 疯狂宇宙 主席+终身制 习兵法 维尼·屎(Winnie##the##Poo) 刁二婚 20000T麦子 习和谐 习大乞 袭包皮 维尼熊给跳跳虎黄牌 梦回大清 信女愿一生吃素 平平 川普的朋友or敌人 领袖习澡水 4中组长 《生物安全法》 嬉包皮 动物森友会 富平学霸刁斤干 庆丰包·勃列日涅夫 习梦死 普近 国贼习近平 小习微信 近身平A 毛二 戏博士 习壳郎 中国爱非洲 WHO的君王 小学博士 这个年很静 重地之战 央视姓党 “无罩”现身 贬词包用 近言 维稳警察（O） 卡近菲 刁远山 2020全面小康 習敗敗 冰棒外交 习包子 塔西佗陷阱 习包子 习大 花花公子 XD 赵家家仆 白猪 独彩者 习卒 Adolf##Xitler 老歪脖子树 “黄袍加身” 指定接班人 “习泽东”和“洪宪”（袁世凯的帝号） 御板泽民 习贼 包帝巡游 皇帝亲临忠诚的武汉 习奥塞斯库、齐奥塞斯库 孢 习殡法 无限连任 刁人13 普习金 没规划的葬礼 野蛮其体魄 习二二（二零二零年五月二十二日开二会） 200吨 十一郎习近平 包大人 吃赵弹 冤大头 习低能儿 初二圣君 连专家也为之叹服的电脑天才 习禁评 习核心 阿平 维尼熊 视频看望 习索里尼 红二代 习张三丰 支那精神野爹 习曱甴 亲自封号 包包大人 习后主 习废帝 疫情蔓延 食腐虫 习特勒 匪酋习维尼 悉包皮 世宗 新影帝 金科律玉 刁后主 戴口赵 习是春竹 人民领袖 习公奭 西朝鲜人民自治岛 太祖兔 孙笑川 集近闭 总书记来过我的家 支那毒王 共哀宗 习二坐船 厕所革命 习总输记 捐麦子 法外狂徒Lucy（德国） 独裁国贼 习“甩锅” 习呆呆 日子像蜜甜 细颈瓶 习大林 役民五术 系包皮 当皇帝的小丑 席近平 亲自删评 亲自指挥 习二胖 习习蛤蛤 邪大大 习奥塞斯库 nmslman（习主席） electron8964 习包皮 影子末帝 细瓶颈 格萨尔 毛泽东2.0 宰相 乳透社##小反旗 刁近猴 xdd shit侯 习emperor 习大郎 宽衣帝 维尼连任 核平全世界 修宪连任 “登基” 大撒幣 二次袁、袁世凯二世、袁二 没有网络安全就没有国家安全 习侯 Corona##Xi（习病毒） 胡志平 皇帝梦 冠子兵法 ChinaXi 晚共昏君 习语录 北京中南海支部书记 䒒(tiáo)菦(qín)苹(píng) 东方project 粪坑兵法 叼斤干 隔离”的金葫芦 彭主席（习主席走了太太接班） 席子兵法 习皇的新装 习驴 毛孙 维尼大帝 习进棺 沼气专家 尼哥 电脑世代586 吸精瓶 习像章 习瘟猪 集金币 修宪帝 老街 通商宽衣 墙内人 shit禁评 法习斯 糖尿维尼 赵王 发皇帝梦 拉清单 shuu##kinn##pei 64岁 习Core 习老八 毛二世 中国的新皇帝 大兔 “皇帝梦” 腊肉馅儿包子 当代秦二世 不敢高声语 读书单 黑白翠 */
package com.pcdd.sonovel.source;

import cn.hutool.core.io.resource.ResourceUtil;
import cn.hutool.core.text.UnicodeUtil;
import cn.hutool.core.util.ReUtil;
import cn.hutool.http.HtmlUtil;
import cn.hutool.http.HttpRequest;
import cn.hutool.json.JSONObject;
import cn.hutool.json.JSONUtil;
import cn.hutool.script.ScriptUtil;
import com.pcdd.sonovel.core.Source;
import com.pcdd.sonovel.model.AppConfig;
import com.pcdd.sonovel.model.Rule;
import com.pcdd.sonovel.util.ConfigUtils;
import lombok.SneakyThrows;
import org.jsoup.Jsoup;
import org.junit.jupiter.api.Test;

import java.util.Map;

/**
 * @author pcdd
 * Created at 2025/1/30
 */
class Rule6Test {

    public static final AppConfig config = ConfigUtils.config();

    @Test
    @SneakyThrows
    void rule6() {
        String script = ResourceUtil.readUtf8Str("js/rule-6.js");
        Object invoke = ScriptUtil.invoke(script, "getParamB", "吞噬星空");
        System.out.println("getParamB = " + invoke);
    }

    @Test
    void crackSearch6() {
        String kw = "我吃西红柿";
        String js = ResourceUtil.readUtf8Str("js/rule-6.js");
        Object key = ScriptUtil.invoke(js, "getParamB", kw);

        Source source = new Source(config);
        Rule.Search ruleSearch = source.rule.getSearch();
        String param = ruleSearch.getData().formatted(kw, key);
        JSONObject obj = JSONUtil.parseObj(param);
        System.out.println(JSONUtil.toJsonPrettyStr(obj));

        Map<String, String> map = JSONUtil.toBean(param, Map.class);
        HttpRequest req = HttpRequest
                .get(ruleSearch.getUrl())
                .header("Referer", ruleSearch.getUrl() + "search.html")
                .formStr(map);

        System.out.println(req.form());
        String body = req.execute().body();
        String s = UnicodeUtil.toString(body);
        String s2 = HtmlUtil.unescape(s)
                .replace("\\r", "")
                .replace("\\n", "")
                .replace("\\t", "")
                .replace("\\/", "/")
                .replace("\\\"", "'");
        String s4 = ReUtil.getGroup0("\\{(.*?)\\}", s2);
        JSONObject jsonObject = JSONUtil.parseObj(s4);
        String html = jsonObject.getStr("content");
        System.out.println(Jsoup.parse(html));
    }

}